function [earth_model]=get_hem(i_line,prem_file,refd,min_thick,...
    th1,th2,th3,th4,th5,th6,th7,th8,...
    vp1,vp2,vp3,vp4,vp5,vp6,vp7,vp8,...
    vs1,vs2,vs3,vs4,vs5,vs6,vs7,vs8,...
    ro1,ro2,ro3,ro4,ro5,ro6,ro7,ro8,...
    bd1,bd9,disc_410,disc_660)
% get_rem
%
% Yong ZHOU
% zhouy3@sustc.edu.cn
% 2018-05-07

crust=[...
    th1(i_line,3),vp1(i_line,3),vs1(i_line,3),ro1(i_line,3);...
    th2(i_line,3),vp2(i_line,3),vs2(i_line,3),ro2(i_line,3);...
    th3(i_line,3),vp3(i_line,3),vs3(i_line,3),ro3(i_line,3);...
    th4(i_line,3),vp4(i_line,3),vs4(i_line,3),ro4(i_line,3);...
    th5(i_line,3),vp5(i_line,3),vs5(i_line,3),ro5(i_line,3);...
    th6(i_line,3),vp6(i_line,3),vs6(i_line,3),ro6(i_line,3);...
    th7(i_line,3),vp7(i_line,3),vs7(i_line,3),ro7(i_line,3);...
    th8(i_line,3),vp8(i_line,3),vs8(i_line,3),ro8(i_line,3);...
    ];...
    crust(crust(:,1)==0,:)=[];

crust_line=cake2line(crust,-bd1(i_line,3));

prem=prem_file.prem;

prem(16,1)=disc_410;
prem(17,1)=disc_410;

prem(22,1)=disc_660;
prem(23,1)=disc_660;

prem=rearrange(prem);

prem_cut=cut_model(prem,-bd9(i_line,3),refd);
earth_model_line=[crust_line;prem_cut];

% earth flattening transform
earth_model_line=eft(earth_model_line);
earth_model=gen_cake(earth_model_line,min_thick);

end